require("../../common/manifest.js")
require("../../common/vendor.js")
global.webpackJsonpMpvue([7],{"1kNa":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("5nAL"),i=a.n(s),c=a("NcgL");new i.a(c.a).$mount()},"1p8d":function(t,e,a){"use strict";var s=a("Dd8w"),i=a.n(s),c=a("Xxa5"),n=a.n(c),r=a("exGp"),o=a.n(r),h=a("Cz8s"),l=a("DofF"),v=a("GGWd"),d=a("oMBN"),u=a("MBXS"),_=a("NYxO");e.a={data:function(){return{value:"",index:0,history:[],showCancel:!1,showIpt:!0,searchData:[{show:!1,more:!1,txt:"",title:"相关攻略",dataList:[]},{show:!1,more:!1,txt:"",title:"相关礼物",dataList:[]}],searchKey:["sways","sgifts"],sheetData:[{showSheet:!1,index:4,tagData:{title:"全部相关攻略",tag:""}},{showSheet:!1,index:5,tagData:{title:"全部相关礼物",tag:""}}]}},created:function(){this.getHistory()},methods:{getVal:function(t){var e=t.mp.detail.value;this.value=e,e?(this.showCancel=!0,this.search()):this.showCancel=!1},close:function(t){var e=this;this.value=t>-1?this.history[t]:"",this.showCancel=!1,this.showIpt=!1,wx.nextTick(function(){e.showIpt=!0})},getHistory:function(){try{var t=wx.getStorageSync("history");if(t){var e=t.split(",");this.history=e.slice(0,e.length-1)}}catch(t){}},delHistory:function(){try{wx.removeStorageSync("history"),this.history=[]}catch(t){this.TOAST("none","清除失败！")}},setHistory:function(t){try{var e=wx.getStorageSync("history");if(e)e.split(",").some(function(e){return e==t})||(e+=t+",",wx.setStorage({key:"history",data:e}));else wx.setStorage({key:"history",data:t+","});this.getHistory()}catch(t){this.TOAST("fail","获取历史记录失败！")}},search:function(t){var e=this;return o()(n.a.mark(function a(){var s,i,c,r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t>-1&&(e.close(t),e.showCancel=!0),e.value=e.value.trim(),!e.value){a.next=16;break}e.setHistory(e.value),wx.showLoading({title:"加载中……"}),s=0;case 6:if(!(s<e.searchData.length)){a.next=16;break}return a.next=9,e.REQUEST(e.value,e.searchKey[s]);case 9:i=a.sent,c=i.data.totalNum,e.searchData[s].dataList=[],200==i.code?c?(e.searchData[s].show=!0,c>1?(e.searchData[s].more=!0,0==s&&(e.searchData[s].txt="查看全部"+c+"条攻略"),1==s&&(e.searchData[s].txt="查看全部"+c+"件商品")):e.searchData[s].more=!1,r=i.data.data,e.searchData[s].dataList=r.slice(0,2),wx.hideLoading(),e.TOAST("none","已加载全部数据")):(e.searchData[s].show=!1,e.searchData[s].more=!1):e.TOAST("fail","获取数据失败！");case 13:s++,a.next=6;break;case 16:case"end":return a.stop()}},a,e)}))()},showSheet:function(t){this.sheetData[t].showSheet=!0,this.index=t},getSheetSatus:function(t){this.sheetData[this.index].showSheet=t},back:function(){wx.navigateBack({delta:1})}},watch:{searchVal:function(t,e){var a=this;this.value=this.searchVal,this.showCancel=!0,this.showIpt=!1,wx.nextTick(function(){a.showIpt=!0}),this.search()}},computed:i()({},Object(_.c)(["searchVal"])),components:{Headers:h.a,More:l.a,Experience:v.a,Recommend:d.a,actionSheet:u.a}}},"6Vay":function(t,e){},BVeo:function(t,e,a){"use strict";var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[a("div",{staticClass:"top_search"},[a("div",{staticClass:"search_wrapper"},[a("div",{staticClass:"search_box"},[a("div",{staticClass:"ipt"},[t.showIpt?a("input",{attrs:{type:"text",placeholder:"搜攻略/礼物/测评",value:t.value,"confirm-type":"search",eventid:"0"},on:{input:t.getVal}}):t._e()]),t._v(" "),t.showCancel?a("van-icon",{staticClass:"cancel",attrs:{name:"close",size:"20",eventid:"1",mpcomid:"0"},on:{click:function(e){t.close(-1)}}}):t._e(),t._v(" "),t._m(0)],1),t._v(" "),a("p",{attrs:{eventid:"2"},on:{click:t.back}},[t._v("取消")])],1)]),t._v(" "),a("div",{staticClass:"top_height"}),t._v(" "),t.history.length?a("div",{staticClass:"history"},[a("div",{staticClass:"title_wrapper"},[a("div",{staticClass:"title"},[t._v("历史搜索")]),t._v(" "),a("van-icon",{staticClass:"delete",attrs:{name:"delete",size:"20",eventid:"3",mpcomid:"1"},on:{click:t.delHistory}})],1),t._v(" "),a("div",{staticClass:"history_list"},t._l(t.history,function(e,s){return a("span",{key:s,attrs:{eventid:"4_"+s},on:{click:function(e){t.search(s)}}},[t._v(t._s(e))])}))]):t._e(),t._v(" "),0==t.searchData[0].show&&0==t.searchData[1].show?a("div",{staticClass:"result"},[a("div",{staticClass:"title"},[t._v("全部相关礼物")])]):t._e(),t._v(" "),t._l(t.searchData,function(e,s){return a("div",{key:s,staticClass:"result"},[e.show?a("div",{staticClass:"title"},[t._v(t._s(e.title))]):t._e(),t._v(" "),0==s?a("div",{staticClass:"result_list"},[a("Experience",{attrs:{dataList:e.dataList,mpcomid:"2_"+s}}),t._v(" "),a("div",{attrs:{eventid:"5_"+s},on:{click:function(e){t.showSheet(s)}}},[e.more?a("More",{attrs:{more:e.txt,mpcomid:"3_"+s}}):t._e()],1)],1):t._e(),t._v(" "),1==s?a("div",{staticClass:"result_list"},[a("Recommend",{attrs:{dataList:e.dataList,mpcomid:"4_"+s}}),t._v(" "),a("div",{attrs:{eventid:"6_"+s},on:{click:function(e){t.showSheet(s)}}},[e.more?a("More",{attrs:{more:e.txt,mpcomid:"5_"+s}}):t._e()],1)],1):t._e()])}),t._v(" "),a("actionSheet",{attrs:{sheetData:t.sheetData[0],eventid:"7",mpcomid:"6"},on:{sheetSatus:t.getSheetSatus}}),t._v(" "),a("actionSheet",{attrs:{sheetData:t.sheetData[1],eventid:"8",mpcomid:"7"},on:{sheetSatus:t.getSheetSatus}})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[e("img",{attrs:{src:"/static/tabs/search.png",alt:""}})])}]};e.a=s},NcgL:function(t,e,a){"use strict";var s=a("1p8d"),i=a("BVeo");var c=function(t){a("6Vay")},n=a("ybqe")(s.a,i.a,c,"data-v-34bf6b47",null);e.a=n.exports}},["1kNa"]);